<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head>
    <meta charset="utf-8">
    <script>
        window.materialVersion = "1.5.2"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1',
            '1.5.0'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">


    <link rel="dns-prefetch" href="https://cdn1.lncld.net"/>


    <link rel="dns-prefetch" href="https://busuanzi.ibruce.info"/>


    <link rel="dns-prefetch" href="https://changyan.sohu.com"/>











    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- Title -->
    
    <title>
        
            ES6之Promise、async和await | 
        
        Lijq&#39;s Blog
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" href="/img/favicon.png">

    <meta name="format-detection" content="telephone=no"/>
    <meta name="description" itemprop="description" content="单线程和异步单线程
JavaScript 这门编程语言从诞生之初有一个特性就是单线程，这个特性随着 JavaScript 以后不断的发展也不会改变。
单线程就是只有一个线程，同一时间只做一件事，两段 JS 不能同时执行。">
    <meta name="keywords" content="web前端,前端开发,前端学习笔记,前端教程,技术博客,ES6">
    <meta name="theme-color" content="#0097A7">

    <!-- Disable Fucking Bloody Baidu Tranformation -->
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(a){try{localStorage.removeItem(a)}catch(b){}};lsloader.setLS=function(a,c){try{localStorage.setItem(a,c)}catch(b){}};lsloader.getLS=function(a){var c="";try{c=localStorage.getItem(a)}catch(b){c=""}return c};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var b=[];for(var a=0;a<localStorage.length;a++){b.push(localStorage.key(a))}b.forEach(function(e){var f=lsloader.getLS(e);if(window.oldVersion){var d=window.oldVersion.reduce(function(g,h){return g||f.indexOf("/*"+h+"*/")!==-1},false);if(d){lsloader.removeLS(e)}}})}catch(c){}};lsloader.clean();lsloader.load=function(f,a,b,d){if(typeof b==="boolean"){d=b;b=undefined}d=d||false;b=b||function(){};var e;e=this.getLS(f);if(e&&e.indexOf(versionString)===-1){this.removeLS(f);this.requestResource(f,a,b,d);return}if(e){var c=e.split(versionString)[0];if(c!=a){console.log("reload:"+a);this.removeLS(f);this.requestResource(f,a,b,d);return}e=e.split(versionString)[1];if(d){this.jsRunSequence.push({name:f,code:e});this.runjs(a,f,e)}else{document.getElementById(f).appendChild(document.createTextNode(e));b()}}else{this.requestResource(f,a,b,d)}};lsloader.requestResource=function(b,e,a,c){var d=this;if(c){this.iojs(e,b,function(h,f,g){d.setLS(f,h+versionString+g);d.runjs(h,f,g)})}else{this.iocss(e,b,function(f){document.getElementById(b).appendChild(document.createTextNode(f));d.setLS(b,e+versionString+f)},a)}};lsloader.iojs=function(d,b,g){var a=this;a.jsRunSequence.push({name:b,code:""});try{var f=new XMLHttpRequest();f.open("get",d,true);f.onreadystatechange=function(){if(f.readyState==4){if((f.status>=200&&f.status<300)||f.status==304){if(f.response!=""){g(d,b,f.response);return}}a.jsfallback(d,b)}};f.send(null)}catch(c){a.jsfallback(d,b)}};lsloader.iocss=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.iofonts=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.runjs=function(f,c,e){if(!!c&&!!e){for(var b in this.jsRunSequence){if(this.jsRunSequence[b].name==c){this.jsRunSequence[b].code=e}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var a=document.createElement("script");a.appendChild(document.createTextNode(this.jsRunSequence[0].code));a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else{if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var d=this;var a=document.createElement("script");a.src=this.jsRunSequence[0].path;a.type="text/javascript";this.jsRunSequence[0].status="loading";a.onload=function(){d.jsRunSequence.shift();if(d.jsRunSequence.length>0){d.runjs()}};document.body.appendChild(a)}}};lsloader.tagLoad=function(b,a){this.jsRunSequence.push({name:a,code:"",path:b,status:"failed"});this.runjs()};lsloader.jsfallback=function(c,b){if(!!this.jsnamemap[b]){return}else{this.jsnamemap[b]=b}for(var a in this.jsRunSequence){if(this.jsRunSequence[a].name==b){this.jsRunSequence[a].code="";this.jsRunSequence[a].status="failed";this.jsRunSequence[a].path=c}}this.runjs()};lsloader.cssfallback=function(e,c,b){if(!!this.cssnamemap[c]){return}else{this.cssnamemap[c]=1}var d=document.createElement("link");d.type="text/css";d.href=e;d.rel="stylesheet";d.onload=d.onerror=b;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(d,a)};lsloader.runInlineScript=function(c,b){var a=document.getElementById(b).innerText;this.jsRunSequence.push({name:c,code:a});this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","/css/material.min.css?Z7a72R1E4SxzBKR/WGctOA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","/css/style.min.css?MKetZV3cUTfDxvMffaOezg==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        
            
                <style id="prettify_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_css","/css/prettify.min.css?zp8STOU9v89XWFEnN+6YmQ==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
                <style id="prettify_theme"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_theme","/css/prettify/atelier-cave-light.min.css?5MK/TK/zbpdHM7rmG+ehCw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
            
        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #43459C !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #43459C !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #43459C !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icons -->


    <style id="material_icons"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_icons","/css/material-icons.css?pqhB/Rd/ab0H2+kZp0RDmw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","/js/jquery.min.js?qcusAULNeBksqffqUM2+Ig==", true)</script>
    

    <!-- WebAPP Icons -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Lijq&#39;s Blog">
    <meta name="msapplication-starturl" content="https://imlijq.github.io/2017/07/08/ES6%E4%B9%8BPromise%E3%80%81async%E5%92%8Cawait/">
    <meta name="msapplication-navbutton-color" content="#0097A7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="Lijq&#39;s Blog">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!-- Site Verification -->
    <meta name="google-site-verification" content="UA-101432039-1" />
    <meta name="baidu-site-verification" content="3915102aad9fde10880d8284f9ac7f69" />

    <!-- RSS -->
    
        
            <link rel=alternate type="application/atom+xml" href="/atom.xml">
        
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="https://imlijq.github.io/2017/07/08/ES6%E4%B9%8BPromise%E3%80%81async%E5%92%8Cawait/">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="ES6之Promise、async和await | Lijq&#39;s Blog">
    <meta property="og:image" content="/img/favicon.png">
    <meta property="og:description" content="单线程和异步单线程
JavaScript 这门编程语言从诞生之初有一个特性就是单线程，这个特性随着 JavaScript 以后不断的发展也不会改变。
单线程就是只有一个线程，同一时间只做一件事，两段 JS 不能同时执行。">
    <meta property="og:article:tag" content="ES6"> 

    
        <meta property="article:published_time" content="Sat Jul 08 2017 00:03:56 GMT+0800">
        <meta property="article:modified_time" content="Mon Nov 05 2018 19:01:14 GMT+0800">
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="https://imlijq.github.io/2017/07/08/ES6%E4%B9%8BPromise%E3%80%81async%E5%92%8Cawait/index.html" />
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "https://imlijq.github.io/2017/07/08/ES6%E4%B9%8BPromise%E3%80%81async%E5%92%8Cawait/index.html",
    "headline": "ES6之Promise、async和await",
    "datePublished": "Sat Jul 08 2017 00:03:56 GMT+0800",
    "dateModified": "Mon Nov 05 2018 19:01:14 GMT+0800",
    "author": {
        "@type": "Person",
        "name": "Lijq",
        "image": {
            "@type": "ImageObject",
            "url": "/uploads/avatar.png"
        },
        "description": "怕什么真理无穷，进一寸有一寸的欢喜"
    },
    "publisher": {
        "@type": "Organization",
        "name": "Lijq&#39;s Blog",
        "logo": {
            "@type":"ImageObject",
            "url": "/img/favicon.png"
        }
    },
    "keywords": ",ES6web前端,前端开发,前端学习笔记,前端教程,技术博客",
    "description": "单线程和异步单线程
JavaScript 这门编程语言从诞生之初有一个特性就是单线程，这个特性随着 JavaScript 以后不断的发展也不会改变。
单线程就是只有一个线程，同一时间只做一件事，两段 JS 不能同时执行。",
}
</script>


    

    <!-- Analytics -->
    
        <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-101432039-1', 'auto');ga('send', 'pageview');
</script>
    
    
        <script>
    var _hmt = _hmt || [];
    (function() {var hm = document.createElement('script');
    hm.src = 'https://hm.baidu.com/hm.js?3915102aad9fde10880d8284f9ac7f69';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(hm, s);
    })();
</script>
    
    

    <!-- Custom Head -->
    

<meta name="generator" content="Hexo 5.4.0"></head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span id="MD-burger-id" class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%8D%95%E7%BA%BF%E7%A8%8B%E5%92%8C%E5%BC%82%E6%AD%A5"><span class="post-toc-number">1.</span> <span class="post-toc-text">单线程和异步</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#jQuery-%E4%B8%AD%E7%9A%84-Deferred-%E5%87%BD%E6%95%B0%E5%92%8C-Promise"><span class="post-toc-number">2.</span> <span class="post-toc-text">jQuery 中的 Deferred 函数和 Promise</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ES6-%E4%B8%AD%E7%9A%84-Promise"><span class="post-toc-number">3.</span> <span class="post-toc-text">ES6 中的 Promise</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Async-%E5%92%8C-Await"><span class="post-toc-number">4.</span> <span class="post-toc-text">Async 和 Await</span></a></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                ES6之Promise、async和await
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/uploads/avatar.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>Lijq</strong>
        <span>7月 08, 2017</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    
        <button id="article-functions-qrcode-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">devices other</i>
    <span class="visuallyhidden">devices other</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-qrcode-button">
    <li class="mdl-menu__item">在其它设备中阅读本文章</li>
    
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQ4AAAEOCAAAAABd2qZ5AAADoUlEQVR42u3aS46jQBAFQN//0jPbkVrG72VStEcKVpaxiyJYJPl5/XH8c7wQ4MCBAwcOHDhw4MDxxRyv+Pj5r2Sdd/9KVnh3tt3Dh5Vx4MCBA8cBjg+h6PI311tM1rn+/hoiv/pbRBw4cODAcYxjdvn2JusUKw7Y7b3gwIEDB47v4WgTsOs0rA3VyQPAgQMHDhz/O0dSnstB2zVx4MCBA8d3cuTlvxxoVhZsG06/VivFgQMHDhxvOPIhgO///Oh8Bw4cOHDg+MGxaQLt21GzNOzeAwcOHDhw3MuRB6o2PWvbRUkxcTOEjQMHDhw4fotjX/KbpYj5KMMs1SwyWhw4cODAcRNHOxaQt4Ly0br2Ki1rEWhx4MCBA8eiOJinSfm4Qxs+20Cep4U4cODAgeNJjnYMLknzZiH5roJj27jCgQMHDhznOPKt5AMKm+RwMwZ3nezhwIEDB45nOIolrhs55abbkl+7wiqFw4EDBw4ct1bD8rC6H03IH0n7+cOLBQ4cOHDguJUjKbolYbUtL7YtpXYPw+IgDhw4cOA4wNEGyLbxk5f88nCbj1PUgRYHDhw4cJQcbWlvU8LLi3f5HtpQPRxowIEDBw4cC45ZyGybQG04TM4mDwAHDhw4cDzJ0ZbY2u/bgYPNAFwR1HHgwIEDxwGOJNXJm0xJGpaP012ndrMSJA4cOHDgOMdxV6Oobf/kqV1eEEwSuWigAQcOHDhwLDiSptGJttAMbsNRv3fgwIEDB44RR3LhaNEgtctvtX1IOQEOHDhw4DjNkQfINmGrA96iKLl5JDhw4MCB416Otl20aVm1iVmb2s2SSRw4cODAcS/HiRtI0q083Obr5I8QBw4cOHA8w5GkPfkIQjsS0YbJNvTWgRYHDhw4cKw5Zi2o2dn2aAfyjrx34MCBAweOUc4yS8xmlElpL0/z2kEKHDhw4MDxDMds/HrGl7e12hJhEcJx4MCBA8dhjjzs5ePO7ShePqYwK0fiwIEDB45zHLMiXZtEzUYW2tvO94kDBw4cOM5xbAbO6nHnoPiY3Fj+EhCVPnHgwIEDxwGO/DbaAYjZb/JgmQfaOqPFgQMHDhxrjrYgOAuZs5RvUxwcBlocOHDgwPEgR9usyoPorIy4anfhwIEDB46v4bi3dJiEz307CgcOHDhwPMnRBrzTgTAnSFY+0nbCgQMHDhxvOPKBhk35bzMSl1+9/hcOHDhw4LiVw4EDBw4cOHDgwIEDB44vO/4C8s74QTtKbRwAAAAASUVORK5CYII=">
    
</ul>

    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-none-link" href="/tags/ES6/" rel="tag">ES6</a>
    </ul>
    

    <!-- Share -->
    
        <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    
    <!-- Leancloud Views -->
        <a class="post_share-link" href="#">
            <li class="mdl-menu__item">
                <span id="/2017/07/08/ES6%E4%B9%8BPromise%E3%80%81async%E5%92%8Cawait/" class="leancloud-views_num" data-flag-title="ES6之Promise、async和await">
     &nbsp;浏览量
</span>

            </li>
        </a>
    

    
        
            <!-- Busuanzi Views -->
            <a class="post_share-link" href="#">
                <li class="mdl-menu__item">
                    <span id="busuanzi_container_page_pv">
                        <span id="busuanzi_value_page_pv"></span>&nbsp;浏览量
                    </span>
                </li>
            </a>
        
    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="https://service.weibo.com/share/share.php?appkey=&title=ES6之Promise、async和await&url=https://imlijq.github.io/2017/07/08/ES6%E4%B9%8BPromise%E3%80%81async%E5%92%8Cawait/index.html&pic=https://imlijq.github.io/img/favicon.png&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=ES6之Promise、async和await&url=https://imlijq.github.io/2017/07/08/ES6%E4%B9%8BPromise%E3%80%81async%E5%92%8Cawait/index.html&via=Lijq" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=https://imlijq.github.io/2017/07/08/ES6%E4%B9%8BPromise%E3%80%81async%E5%92%8Cawait/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=https://imlijq.github.io/2017/07/08/ES6%E4%B9%8BPromise%E3%80%81async%E5%92%8Cawait/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

    
</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h2 id="单线程和异步"><a href="#单线程和异步" class="headerlink" title="单线程和异步"></a>单线程和异步</h2><p><strong>单线程</strong></p>
<p>JavaScript 这门编程语言从诞生之初有一个特性就是单线程，这个特性随着 JavaScript 以后不断的发展也不会改变。</p>
<p>单线程就是只有一个线程，同一时间只做一件事，两段 JS 不能同时执行。</p>
<span id="more"></span>
<p>浏览器在加载一个页面时，需要根据服务器返回数据，渲染 DOM。而 JS 是可以操作、修改 DOM 的，JS 执行期间会阻塞浏览器的 DOM 渲染，这也就是为什么我们提倡将页面引入的 JS 文件放到 body 底部的原因。JS 必须是单线程的，因为如果两段 JS 代码同时操作一个 DOM 节点，浏览器无法判断应该如何执行，JS 单线程的目的就是避免 DOM 操作的冲突。HTML5 中提供了 Web Worker 的特性，可以开启多个线程，但在 Web Worker 中不能访问 DOM，目的当然也是为了避免 DOM 操作冲突，Web Worker 的出现也没有改变 JS 单线程的本质。</p>
<pre><code class="js">    // 循环执行执行期间，JS 执行和 DOM 渲染暂时卡顿
    var i, sum=0;
    for(i=0;i&lt;1000000000;i++)&#123;
        sum+=i;
    &#125;
    console.log(sum);


    // alert 不处理，JS 执行和 DOM 渲染暂时卡顿
    console.log(1);
    alert(&quot;hello&quot;);
    console.log(2);
</code></pre>
<p><strong>异步</strong></p>
<p>单线程的解决方案就是异步。浏览器发起一个请求之后，总不能一直等待有了响应才去执行下边的代码，而是请求之后继续执行下面代码，等服务器返回相应执行相应的回调。异步解决了 JS 单线程的问题，但是通过回调函数的这种方式也有自己的缺点，比如没有按照代码书写的顺序执行，可读性差等。</p>
<pre><code class="js">    console.log(100);
    setTimeout(function()&#123;
        console.log(200); // 直接跳过，继续执行后边代码
    &#125;,1000);              
    console.log(300);
    console.log(400);
</code></pre>
<pre><code class="js">    console.log(100);
    $.ajax(&#123;
        url:&quot;xxx&quot;,
        success: function(result)&#123; // 请求成功才会执行回调，不影响后面代码执行
            console.log(result); 
        &#125;
    &#125;);
    console.log(300);
    console.log(400);
</code></pre>
<p><strong>Event Loop</strong></p>
<p>Event Loop 通常被称为事件轮询、事件循环，是异步的具体实现方式。浏览器在执行 JS 代码时，首先会立刻执行所有的同步代码，异步函数会放入异步队列中，等待所有的同步代码执行完毕后，才会轮询执行异步队列中的代码</p>
<pre><code class="js">    setTimeout(function()&#123; // 异步函数先放异步队列中
        console.log(100);
    &#125;, 1000);
    console.log(200); // 同步函数在主进程中，立刻执行 
</code></pre>
<pre><code class="js">    setTimeout(function()&#123; // 100ms 后放到异步队列中
        console.log(1); 
    &#125;, 100);
    setTimeout(function()&#123; // 立刻放到异步队列中（定时器有个最短时间限制，实际为 4ms）
        console.log(2);
    &#125;);
    console.log(3); // 主进程
    // 按顺序输出 3 2 1
</code></pre>
<h2 id="jQuery-中的-Deferred-函数和-Promise"><a href="#jQuery-中的-Deferred-函数和-Promise" class="headerlink" title="jQuery 中的 Deferred 函数和 Promise"></a>jQuery 中的 Deferred 函数和 Promise</h2><p>Deferred 是 jQuery 1.5 版本中出现的一个构造函数，可以创建一个延迟执行的对象实例，该实例有两类方法：</p>
<ul>
<li>resolve、reject（主动触发的方法）</li>
<li>done、fail、then（监听的方法，可传入回调函数）</li>
</ul>
<p>done 方法中传入成功回调，执行成功后会执行，代码内部对应的是 resolve 方法，fail 中传入失败回调，对应 reject 方法。done 和 fail 方法可以 then 方法代替，then 方法中传入成功、失败函数两个参数</p>
<pre><code class="js">    var wait=function()&#123;
        var task=function()&#123;
            console.log(&quot;执行完成&quot;);
        &#125;
        setTimeout(task, 2000);
    &#125;
    wait();
</code></pre>
<p>上面代码使用 Deferred 后，代码更加容易扩展：</p>
<pre><code class="js">    function waitHandle()&#123;
        var dtd=$.Deferred(); // 创建一个 deferred 对象

        var wait = function (dtd) &#123;
            var task=function()&#123;
                console.log(&quot;执行完成&quot;);
                dtd.resolve(); // 表示异步任务已经完成
                // dtd.reject(); // 表示异步任务失败或出错
            &#125;
            setTimeout(task, 2000);
            return dtd;
        &#125;

        return wait(dtd);
    &#125;

    var result = waitHandle();
    // result.reject(); // 执行这个不报错，会导致后边都走 error 的回调，影响结果 
    result.then(function()&#123;
        console.log(&quot;ok 1&quot;);
    &#125;, function()&#123;
        console.log(&quot;error 1&quot;);
    &#125;)
    result.then(function()&#123;
        console.log(&quot;ok 2&quot;);
    &#125;, function()&#123;
        console.log(&quot;error 2&quot;);
    &#125;)
</code></pre>
<p>但由于 Deferred 有两类方法，在 then/done/fail 这种监听方法前主动 resolve/reject 方法，代码不会报错，会直接影响回调执行的结果，可以调用实例对象的 promise 方法，该方法返回一个 promise 对象，promise 对象中没有 resolve/reject 这类方法，所以不会出现这个问题：</p>
<pre><code class="js">    function waitHandle()&#123;
        var dtd=$.Deferred();

        var wait = function (dtd) &#123; 
            var task=function()&#123;
                console.log(&quot;执行完成&quot;);
                dtd.resolve();
                // dtd.reject();
            &#125;
            setTimeout(task, 2000);
            return dtd.promise(); // 这里返回的是 promise 对象而不是直接返回 deferred 对象
        &#125;

        return wait(dtd); 
    &#125;

    var result = waitHandle(); // promise 对象（没有 resolve/reject 方法）
    // result.resolve(); // Uncaught TypeError: result.resolve is not a function
    $.when(result).then(function () &#123;
        console.log(&quot;ok 1&quot;);
    &#125;, function()&#123;
        console.log(&quot;error 1&quot;);
    &#125;) 
    $.when(result).then(function()&#123;
        console.log(&quot;ok 2&quot;);
    &#125;, function()&#123;
        console.log(&quot;error 2&quot;);
    &#125;)
</code></pre>
<h2 id="ES6-中的-Promise"><a href="#ES6-中的-Promise" class="headerlink" title="ES6 中的 Promise"></a>ES6 中的 Promise</h2><p>使用 Promise 构造函数创建实例对象，构造函数中传入一个函数，函数有两个参数：resolve 和 reject，分别作为执行成功、失败时要调用的方法，使用 then 方法监听结果</p>
<pre><code class="js">    // ES5
    function loadImg(src, callback, fail)&#123;
        var img=document.createElement(&quot;img&quot;);
        img.onload=function()&#123;
            callback(img);
        &#125;
        img.onerror=function()&#123;
            fail();
        &#125;
        img.src=src;
    &#125;
    var src=&quot;http://www.imooc.com/static/img/index/logo_new.png&quot;;
    loadImg(src, function(img)&#123;
        console.log(img.width);
    &#125;,function() &#123;
        console.log(&quot;failed&quot;);
    &#125;);
</code></pre>
<p>使用 Promise 语法：</p>
<pre><code class="js">    function loadImg(src)&#123; 
        const promise=new Promise(function(resolve, reject)&#123;
            var img=document.createElement(&quot;img&quot;);
            img.onload=function()&#123;
                resolve(img); // 成功时执行的函数
            &#125;
            img.onerror=function()&#123;
                reject(); // 失败时执行的函数
            &#125;
            img.src=src;
        &#125;);
        return promise;
    &#125;
    var src=&quot;http://www.imooc.com/static/img/index/logo_new.png&quot;;
    var result=loadImg(src);
    result.then((img)=&gt;&#123; // 成功回调
        console.log(img.width);
    &#125;, function()&#123; // 失败回调
        console.log(&quot;error&quot;);
    &#125;);
</code></pre>
<p><strong>Promise 中的异常捕获</strong></p>
<p>Promise 实例可以使用 catch 方法统一捕获异常，then 相应只需要传入一个成功回调方法</p>
<pre><code class="js">    function loadImg(src) &#123;
        const promise = new Promise(function (resolve, reject) &#123;
            var img = document.createElement(&quot;img&quot;);
            throw new Error(&quot;自定义错误&quot;);
            img.onload = function () &#123;
                resolve(img);
            &#125;
            img.onerror = function () &#123;
                reject(); 
            &#125;
            img.src = src;
        &#125;);
        return promise;
    &#125;

    var src = &quot;http://www.imooc.com/static/img/index/logo_new.png&quot;;

    var result = loadImg(src);

    result.then((img) =&gt; &#123;
        console.log(&quot;width&quot;,img.width);
        return img;
    &#125;).then(function(img)&#123;
        console.log(&quot;height&quot;,img.height);
    &#125;).catch(function(ex)&#123;
        // 最后统一用 catch 捕获异常
        console.log(ex);
    &#125;);
</code></pre>
<pre><code class="js">    function loadImg(src) &#123;
        const promise = new Promise(function (resolve, reject) &#123;
            var img = document.createElement(&quot;img&quot;);
            img.onload = function () &#123;
                resolve(img);
            &#125;
            img.onerror = function () &#123;
                reject(&quot;图片加载失败&quot;);
            &#125;
            img.src = src;
        &#125;);
        return promise;
    &#125;

    var src = &quot;http://www.imooc.com/static/img/index/logo_new1.png&quot;;

    var result = loadImg(src);

    result.then((img) =&gt; &#123;
        console.log(&quot;width&quot;,img.width);
        return img; 
    &#125;).then(function(img)&#123;
        console.log(&quot;height&quot;,img.height);
    &#125;).catch(function(ex)&#123;
        console.log(ex); // 图片加载失败
    &#125;);
</code></pre>
<p><strong>顺序执行多个回调</strong></p>
<pre><code class="js">    function loadImg(src) &#123;
        const promise = new Promise(function (resolve, reject) &#123;
            var img = document.createElement(&quot;img&quot;);
            img.onload = function () &#123;
                resolve(img);
            &#125;
            img.onerror = function () &#123;
                reject(&quot;图片加载失败&quot;);
            &#125;
            img.src = src;
        &#125;);
        return promise;
    &#125;
    var src1 = &quot;http://www.imooc.com/static/img/index/logo_new.png&quot;;
    var result1 = loadImg(src1);
    var src2 = &quot;https://www.baidu.com/img/bd_logo1.png?where=super&quot;;
    var result2 = loadImg(src2);

    result1.then((img) =&gt; &#123;
        console.log(&quot;第一个图片加载完成&quot;, img); 
        return result2; // 返回 result2 后，下一个 then 中监听的是 result2
    &#125;).then(function (img) &#123;
        console.log(&quot;第二个图片加载完成&quot;, img);
    &#125;).catch(function (ex) &#123;
        console.log(ex);
    &#125;);
</code></pre>
<p><strong>Promise.all 和 Promise.race 方法</strong></p>
<p>Promise.all 接收一个包含多个 promise 对象的数组，所有的 promise 对象执行成功回调后，才会 then 中的方法</p>
<p>Promise.race 接收一个包含多个 promise 对象的数组，只要有一个 promise 对象执行成功回调，就会执行 then 中方法</p>
<pre><code class="js">    function loadImg(src) &#123;
        const promise = new Promise(function (resolve, reject) &#123;
            var img = document.createElement(&quot;img&quot;);
            img.onload = function () &#123;
                resolve(img);
            &#125;
            img.onerror = function () &#123;
                reject(&quot;图片加载失败&quot;);
            &#125;
            img.src = src;
        &#125;);
        return promise;
    &#125;

    var src1 = &quot;http://www.imooc.com/static/img/index/logo_new.png&quot;;
    var result1 = loadImg(src1);
    var src2 = &quot;https://www.baidu.com/img/bd_logo1.png?where=super&quot;;
    var result2 = loadImg(src2);

    Promise.all([result1, result2]).then(datas=&gt;&#123;
        console.log(datas); // [img, img]
        console.log(datas[0]); // &lt;img src=&quot;http://www.imooc.com/static/img/index/logo_new.png&quot;&gt;
        console.log(datas[1]); // &lt;img src=&quot;https://www.baidu.com/img/bd_logo1.png?where=super&quot;&gt;
    &#125;);

    Promise.race([result1, result2]).then(data=&gt;&#123;
        // data 即最先执行完成的 promise 的返回值
        console.log(data);
    &#125;);
</code></pre>
<h2 id="Async-和-Await"><a href="#Async-和-Await" class="headerlink" title="Async 和 Await"></a>Async 和 Await</h2><p>async/await 对 Promise 进行了封装，可以使用同步的写法代替之前必须要传入回调的写法</p>
<pre><code class="js">    function loadImg(src) &#123;
        const promise = new Promise(function (resolve, reject) &#123;
            var img = document.createElement(&quot;img&quot;);
            img.onload = function () &#123;
                resolve(img);
            &#125;
            img.onerror = function () &#123;
                reject(&quot;图片加载失败&quot;);
            &#125;
            img.src = src;
        &#125;);
        return promise;
    &#125;
    var src1 = &quot;http://www.imooc.com/static/img/index/logo_new.png&quot;;
    var src2 = &quot;https://www.baidu.com/img/bd_logo1.png?where=super&quot;;

    const load=async function()&#123;
        const result1 = await loadImg(src1);
        console.log(result1);
        const result2=await loadImg(src2);
        console.log(result2);
    &#125;
    load();
</code></pre>

        
                <blockquote style="margin: 2em 0 0;padding: 0.5em 1em;border-left: 3px solid #F44336;background-color: #F5F5F5;list-style: none;">
                    <p><strong>
                         
                            本文使用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/3.0/cn/">CC BY-NC-SA 3.0 中国大陆</a> 协议许可
                        </strong>
                        <br>
                        <strong>本文链接：</strong><a href="https://imlijq.github.io/2017/07/08/ES6%E4%B9%8BPromise%E3%80%81async%E5%92%8Cawait/">https://imlijq.github.io/2017/07/08/ES6%E4%B9%8BPromise%E3%80%81async%E5%92%8Cawait/</a>
                    </p>
                </blockquote>
        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
    <!-- 使用 changyan -->
<div id="changyan-comment">
    <!--PC和WAP自适应版-->
<div id="SOHUCS" sid="2017/07/08/ES6之Promise、async和await/"  ></div>
<script type="text/javascript">
(function(){
var appid = 'cytTQ56sk';
var conf = 'prod_72746497bcc8a757b36c46ef4c37389c';
var width = window.innerWidth || document.documentElement.clientWidth;
if (width < 960) {
window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>'); } else { var loadJs=function(d,a){var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","UTF-8");b.setAttribute("src",d);if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};loadJs("https://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})}); } })(); </script>

</div>
<style>
    #changyan-comment{
        background-color: #eee;
        padding: 2pc;
    }
</style>

                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2017/11/26/Vue-js%E5%B8%B8%E8%A7%81%E7%94%A8%E6%B3%95/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2017/07/02/ES6%E4%B9%8B%E7%BB%93%E6%9E%84%E8%B5%8B%E5%80%BC/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/random/material-3.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/uploads/avatar.png" alt="Lijq's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        imlijq@gmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="mailto:imlijq@gmail.com" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">archive</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2018/03/">三月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/11/">十一月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/07/">七月 2017<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/06/">六月 2017<span class="sidebar_archives-count">1</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/Web%E5%89%8D%E7%AB%AF/">Web前端<span class="sidebar_archives-count">6</span></a>
            </ul>
        </li>
        
    

    <!-- Pages  -->
    
        <li>
            <a href="/tags" title="标签云">
                
                    <i class="material-icons sidebar-material-icons">label</i>
                
                标签云
            </a>
        </li>
        
    
        <li>
            <a href="/timeline" title="时间轴">
                
                    <i class="material-icons sidebar-material-icons">timeline</i>
                
                时间轴
            </a>
        </li>
        
    
        <li>
            <a href="/about" title="关于我">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                关于我
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
</ul>


        <!-- Sidebar Footer -->
        

<!-- Sidebar Divider -->


<!-- Theme Material -->


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
    
    <!-- V2EX -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;2017&nbsp;-<script type="text/javascript">var fd = new Date();document.write("&nbsp;" + fd.getFullYear() + "&nbsp;");</script>Lijq's Blog
            
                <br>
                
                    <a href="http://www.miitbeian.gov.cn" rel="nofollow" target="_blank">京ICP备18054880号-1</a>
                
            
        </div>

        <!-- Paradox Footer Right Section -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>

                <!-- 新加内容 -->
                <div class="footer-develop-div">Comment -
                    <a href="https://github.com/imsun/gitment" target="_blank" class="footer-develop-a">Gitment</a>
                </div>
                <div class="footer-develop-div">OSS -
                    <a href="https://www.upyun.com/" target="_blank" class="footer-develop-a">
                        <img src="/uploads/youpaiyun.png" alt="upyun_logo" width="55.3px" height="24.1px">
                    </a>
                </div>
            </div>
        </div>
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==", true)</script>



    <script>lsloader.load("js_js","/js/js.min.js?d+XW6aNuIPgOn1iA7NnB4g==", true)</script>



    <script>lsloader.load("np_js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>





    <!-- Leancloud -->
    <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
    <script>
        AV.initialize('S3Ea2Ab7bTzv1TfyTcizcNN6-gzGzoHsz', 'tCJwasmp1skGigu3X9Bl5rPm');
    </script>
    <script type="text/ls-javascript" id="leancloud-views-script">
    function showTime(Counter) {
        var query = new AV.Query(Counter);
        $('.leancloud-views_num').each(function() {
            var url = $(this).attr('id').trim();
            query.equalTo('url', url);
            query.find({
                success: function(results) {
                    if (results.length === 0) {
                        var content = '0 ' + $(document.getElementById(url)).text();
                        $(document.getElementById(url)).text(content);
                        return;
                    }
                    for (var i = 0; i < results.length; i++) {
                        var object = results[i];
                        var content = object.get('time') + ' ' + $(document.getElementById(url)).text();
                        $(document.getElementById(url)).text(content);
                    }
                },
                error: function(object, error) {
                    console.log('Error: ' + error.code + ' ' + error.message);
                }
            });
        });
    }

    function addCount(Counter) {
      var Counter = AV.Object.extend('Counter');
      url = $('.leancloud-views_num').attr('id').trim();
      title = $('.leancloud-views_num').attr('data-flag-title').trim();
      var query = new AV.Query(Counter);
      query.equalTo('url', url);
      query.find({
          success: function(results) {
            if (results.length > 0) {
                var counter = results[0];
                counter.fetchWhenSave(true);
                counter.increment('time');
                counter.save(null, {
                    success: function(counter) {
                        var content =  counter.get('time') + ' ' + $(document.getElementById(url)).text();
                        $(document.getElementById(url)).text(content);
                    },
                    error: function(counter, error) {
                        console.log('Failed to save Visitor num, with error message: ' + error.message);
                    }
                });
            } else {
              var newcounter = new Counter();
              newcounter.set('title', title);
              newcounter.set('url', url);
              newcounter.set('time', 1);
              newcounter.save(null, {
                  success: function(newcounter) {
                      console.log('newcounter.get(\'time\')='+newcounter.get('time'));
                      var content = newcounter.get('time') + ' ' + $(document.getElementById(url)).text();
                      $(document.getElementById(url)).text(content);
                  },
                  error: function(newcounter, error) {
                      console.log('Failed to create');
                  }
              });
            }
        },
        error: function(error) {
            console.log('Error:' + error.code + ' ' + error.message);
        }
      });
    }
    $(function() {
        var Counter = AV.Object.extend('Counter');
        if ($('.leancloud-views_num').length === 1) {
            addCount(Counter);
        } else if ($('.post-title-link').length > 1) {
            showTime(Counter);
        }
    });
</script>




    <!-- Busuanzi -->
    <script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



   <!-- 畅言公共 js 代码 start -->
<script id="cy_cmt_num" src="https://changyan.sohu.com/upload/plugins/plugins.list.count.js?clientId=cytTQ56sk">
</script>
<!-- 畅言公共 js 代码 end -->





<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('
<link rel="stylesheet" href="/css/uc.css">
');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->

    
        
            <script>lsloader.load("prettify_js","/js/prettify.min.js?WN07fivHQSMKWy7BmHBB6w==", true)</script>
        
    



<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
        
            $(function() {
                $('pre').addClass('prettyprint linenums').attr('style', 'overflow:auto;');
                prettyPrint();
                })
        
    
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
// console.log('\n %c © Material Theme | Version: 1.5.2 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
